name: luseepy-test
on:
  # Triggers the workflow on push or pull request events but only for the main branch
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

  # Enable manual activation, too
  workflow_dispatch:
jobs:
  luseepy-test:
    runs-on: ubuntu-latest
    env:
       PYTHONPATH: .:..
       LUSEE_DRIVE_DIR: Drive
    container: buddhasystem/lusee-night-pyshtools:0.1 # ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - run: wget "https://drive.google.com/uc?export=download&id=1W780SR2yMWAMO8kZZkdvAtclD_9yJnEx" -O drive.tgz
      - run: tar zxvf drive.tgz
      - run: python tests/LunarCalendarTest.py  -v
      - run: python tests/CoordTest.py
      - run: python tests/SimTest.py
      - run: cd simulation; ln -s ../Drive .; mkdir output; python driver/run_sim.py config/example.yaml
